<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
<meta name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">

    <meta name="author" content="Gazettm">





<title>NJU_linklab | Gazettm&#39;s Blog</title>



    <link rel="icon" href="/favicon.ico">




    <!-- stylesheets list from _config.yml -->
    
    <link rel="stylesheet" href="/css/style.css">
    



    <!-- scripts list from _config.yml -->
    
    <script src="/js/script.js"></script>
    
    <script src="/js/tocbot.min.js"></script>
    



    
    
        
    


<meta name="generator" content="Hexo 7.3.0"></head>

<body>
    <script>
        // this function is used to check current theme before page loaded.
        (() => {
            const currentTheme = window.localStorage && window.localStorage.getItem('theme') || '';
            const isDark = currentTheme === 'dark';
            const pagebody = document.getElementsByTagName('body')[0]
            if (isDark) {
                pagebody.classList.add('dark-theme');
                // mobile
                document.getElementById("mobile-toggle-theme").innerText = "· Dark"
            } else {
                pagebody.classList.remove('dark-theme');
                // mobile
                document.getElementById("mobile-toggle-theme").innerText = "· Light"
            }
        })();
    </script>

    <div class="wrapper">
        <header>
    <nav class="navbar">
        <div class="container">
            <div class="navbar-header header-logo"><a href="/">Gazettm&#39;s Blog</a></div>
            <div class="menu navbar-right">
                
                    <a class="menu-item" href="/archives">Posts</a>
                
                    <a class="menu-item" href="/categories">Categories</a>
                
                    <a class="menu-item" href="/tags">Tags</a>
                
                    <a class="menu-item" href="/about">About</a>
                
                <input id="switch_default" type="checkbox" class="switch_default">
                <label for="switch_default" class="toggleBtn"></label>
            </div>
        </div>
    </nav>

    
    <nav class="navbar-mobile" id="nav-mobile">
        <div class="container">
            <div class="navbar-header">
                <div>
                    <a href="/">Gazettm&#39;s Blog</a><a id="mobile-toggle-theme">·&nbsp;Light</a>
                </div>
                <div class="menu-toggle" onclick="mobileBtn()">&#9776; Menu</div>
            </div>
            <div class="menu" id="mobile-menu">
                
                    <a class="menu-item" href="/archives">Posts</a>
                
                    <a class="menu-item" href="/categories">Categories</a>
                
                    <a class="menu-item" href="/tags">Tags</a>
                
                    <a class="menu-item" href="/about">About</a>
                
            </div>
        </div>
    </nav>

</header>
<script>
    var mobileBtn = function f() {
        var toggleMenu = document.getElementsByClassName("menu-toggle")[0];
        var mobileMenu = document.getElementById("mobile-menu");
        if(toggleMenu.classList.contains("active")){
           toggleMenu.classList.remove("active")
            mobileMenu.classList.remove("active")
        }else{
            toggleMenu.classList.add("active")
            mobileMenu.classList.add("active")
        }
    }
</script>
            <div class="main">
                <div class="container">
    
    
        <div class="post-toc">
    <div class="tocbot-list">
    </div>
    <div class="tocbot-list-menu">
        <a class="tocbot-toc-expand" onclick="expand_toc()">Expand all</a>
        <a onclick="go_top()">Back to top</a>
        <a onclick="go_bottom()">Go to bottom</a>
    </div>
</div>

<script>
    var tocbot_timer;
    var DEPTH_MAX = 6; // 为 6 时展开所有
    var tocbot_default_config = {
        tocSelector: '.tocbot-list',
        contentSelector: '.post-content',
        headingSelector: 'h1, h2, h3, h4, h5',
        orderedList: false,
        scrollSmooth: true,
        onClick: extend_click,
    };

    function extend_click() {
        clearTimeout(tocbot_timer);
        tocbot_timer = setTimeout(function() {
            tocbot.refresh(obj_merge(tocbot_default_config, {
                hasInnerContainers: true
            }));
        }, 420); // 这个值是由 tocbot 源码里定义的 scrollSmoothDuration 得来的
    }

    document.ready(function() {
        tocbot.init(obj_merge(tocbot_default_config, {
            collapseDepth: 1
        }));
    });

    function expand_toc() {
        var b = document.querySelector('.tocbot-toc-expand');
        var expanded = b.getAttribute('data-expanded');
        expanded ? b.removeAttribute('data-expanded') : b.setAttribute('data-expanded', true);
        tocbot.refresh(obj_merge(tocbot_default_config, {
            collapseDepth: expanded ? 1 : DEPTH_MAX
        }));
        b.innerText = expanded ? 'Expand all' : 'Collapse all';
    }

    function go_top() {
        window.scrollTo(0, 0);
    }

    function go_bottom() {
        window.scrollTo(0, document.body.scrollHeight);
    }

    function obj_merge(target, source) {
        for (var item in source) {
            if (source.hasOwnProperty(item)) {
                target[item] = source[item];
            }
        }
        return target;
    }
</script>
    

    
    <article class="post-wrap">
        <header class="post-header">
            <h1 class="post-title">NJU_linklab</h1>
            
                <div class="post-meta">
                    
                        Author: <a itemprop="author" rel="author" href="/">Gazettm</a>
                    

                    
                        <span class="post-time">
                        Date: <a href="#">十二月 26, 2025&nbsp;&nbsp;20:59:06</a>
                        </span>
                    
                    
                        <span class="post-category">
                    Category:
                            
                                <a href="/categories/CSAPP/">CSAPP</a>
                            
                        </span>
                    
                </div>
            
        </header>

        <div class="post-content">
            <h1 id="NJU-linklab"><a href="#NJU-linklab" class="headerlink" title="NJU_linklab"></a>NJU_linklab</h1><p>这个实验是由南京大学做的，仿照bufbomb来做的一个linklab，也是类似于闯关。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">linux&gt; gcc -no-pie -o linkbomb main.o phase1.o </span><br><span class="line">linux&gt; ./linkbomb </span><br><span class="line">linux&gt; 学号 </span><br></pre></td></tr></table></figure>

<p>这个是验证方法，出于隐私，我们将学号设置为123456789。</p>
<h2 id="phase1"><a href="#phase1" class="headerlink" title="phase1"></a>phase1</h2><h3 id="任务"><a href="#任务" class="headerlink" title="任务"></a>任务</h3><p>修改二进制可重定位目标文件“phase1.o”的.data 节的内容（注意不允许修改其它节 的内容），使其如下与main.o模块链接后运行时输出（且仅输出）学号</p>
<h3 id="解决"><a href="#解决" class="headerlink" title="解决"></a>解决</h3><p>这个题给了<code>phase1.o</code>，经过反编译之后我们看到</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">phase1.o：     文件格式 elf32-i386</span><br><span class="line">Disassembly of section .text:</span><br><span class="line"></span><br><span class="line">00000000 &lt;do_phase&gt;:</span><br><span class="line">   0:   55                      push   %ebp</span><br><span class="line">   1:   89 e5                   mov    %esp,%ebp</span><br><span class="line">   3:   83 ec 08                sub    $0x8,%esp</span><br><span class="line">   6:   b8 1f 01 00 00          mov    $0x11f,%eax</span><br><span class="line">   b:   83 ec 0c                sub    $0xc,%esp</span><br><span class="line">   e:   50                      push   %eax</span><br><span class="line">   f:   e8 fc ff ff ff          call   10 &lt;do_phase+0x10&gt;</span><br><span class="line">  14:   83 c4 10                add    $0x10,%esp</span><br><span class="line">  17:   90                      nop</span><br><span class="line">  18:   c9                      leave  </span><br><span class="line">  19:   c3                      ret  </span><br></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">do_phase</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">puts</span>(s);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这个是do_phase做的。</p>
<p>观察这里的逻辑，以下两条很重要</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">6:   b8 1f 01 00 00          mov    $0x11f,%eax</span><br><span class="line"></span><br><span class="line">e:   50                      push   %eax</span><br></pre></td></tr></table></figure>

<p>这里是可重定位目标文件，这条指令将偏移量<code>0x11f</code>处的字符的地址<code>push</code>到了<code>eax</code>中作为参数传递并<code>puts</code>函数输出。这里我们可以得到以下信息。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">  [Nr] Name              Type            Addr     Off    Size   ES Flg Lk Inf Al</span><br><span class="line">  [ 0]                   NULL            00000000 000000 000000 00      0   0  0</span><br><span class="line">  [ 1] .text             PROGBITS        00000000 000034 00001a 00  AX  0   0  1</span><br><span class="line">  [ 2] .rel.text         REL             00000000 0003b4 000010 08   I 11   1  4</span><br><span class="line">  [ 3] .data             PROGBITS        00000000 000060 0001c4 00  WA  0   0 32</span><br><span class="line">  [ 4] .rel.data         REL             00000000 0003c4 000010 08   I 11   3  4</span><br><span class="line">  [ 5] .bss              NOBITS          00000000 000224 000000 00  WA  0   0  1</span><br><span class="line">  [ 6] .rodata           PROGBITS        00000000 000224 000002 00   A  0   0  1</span><br><span class="line">  [ 7] .comment          PROGBITS        00000000 000226 00001d 01  MS  0   0  1</span><br><span class="line">  [ 8] .note.GNU-stack   PROGBITS        00000000 000243 000000 00      0   0  1</span><br><span class="line">  [ 9] .eh_frame         PROGBITS        00000000 000244 000038 00   A  0   0  4</span><br><span class="line">  [10] .rel.eh_frame     REL             00000000 0003d4 000008 08   I 11   9  4</span><br><span class="line">  [11] .symtab           SYMTAB          00000000 00027c 000100 10     12  12  4</span><br><span class="line">  [12] .strtab           STRTAB          00000000 00037c 000038 00      0   0  1</span><br><span class="line">  [13] .shstrtab         STRTAB          00000000 0003dc 000063 00      0   0  1</span><br><span class="line">Key to Flags:</span><br><span class="line">  W (write), A (alloc), X (execute), M (merge), S (strings), I (info),</span><br><span class="line">  L (link order), O (extra OS processing required), G (group), T (TLS),</span><br><span class="line">  C (compressed), x (unknown), o (OS specific), E (exclude),</span><br><span class="line">  p (processor specific)</span><br></pre></td></tr></table></figure>

<p><code>.data</code>节在偏移量<code>0x60</code>的地方，所以可以算出来需要修改的地方在这个可重定位目标文件的<code>0x17f</code>处，使用<code>hexedit</code>工具，进行修改，填充<code>0x31</code>到<code>0x39</code>，在填充<code>0x00</code>截止字符串，即可输出正常数据。（在idapro中，可以找到交叉引用，ida自动定义了一个字符数组s来提醒。）</p>
<h2 id="phase2"><a href="#phase2" class="headerlink" title="phase2"></a>phase2</h2><h3 id="任务-1"><a href="#任务-1" class="headerlink" title="任务"></a>任务</h3><p>修改二进制可重定位目标文件“phase2.o”的.text节的内容（注意不允许修改其它节的 内容），使其如下与main.o模块链接后运行时输出（且仅输出）学号</p>
<h3 id="解决-1"><a href="#解决-1" class="headerlink" title="解决"></a>解决</h3><p>反编译<code>phase2</code></p>
<p>经研究我们发现<code>do_phase</code>为空，所以我们必须填入一些值，能让这个代码正确输出123456789。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br></pre></td><td class="code"><pre><span class="line">phase1.o：     文件格式 elf32-i386</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Disassembly of section .text:</span><br><span class="line"></span><br><span class="line">00000000 &lt;IhCtSRZPQx&gt;:</span><br><span class="line">   0:   55                      push   %ebp</span><br><span class="line">   1:   89 e5                   mov    %esp,%ebp</span><br><span class="line">   3:   83 ec 38                sub    $0x38,%esp</span><br><span class="line">   6:   c7 45 cc 39 6b 44 70    movl   $0x70446b39,-0x34(%ebp)</span><br><span class="line">   d:   c7 45 d0 6b 76 68 4c    movl   $0x4c68766b,-0x30(%ebp)</span><br><span class="line">  14:   c7 45 d4 59 68 35 49    movl   $0x49356859,-0x2c(%ebp)</span><br><span class="line">  1b:   c7 45 d8 66 52 6c 66    movl   $0x666c5266,-0x28(%ebp)</span><br><span class="line">  22:   c7 45 dc 77 57 67 69    movl   $0x69675777,-0x24(%ebp)</span><br><span class="line">  29:   c7 45 e0 6a 73 67 7a    movl   $0x7a67736a,-0x20(%ebp)</span><br><span class="line">  30:   c7 45 e4 66 36 58 71    movl   $0x71583666,-0x1c(%ebp)</span><br><span class="line">  37:   c7 45 e8 36 65 32 6d    movl   $0x6d326536,-0x18(%ebp)</span><br><span class="line">  3e:   c7 45 ec 36 77 6e 33    movl   $0x336e7736,-0x14(%ebp)</span><br><span class="line">  45:   c7 45 f0 68 6f 4b 00    movl   $0x4b6f68,-0x10(%ebp)</span><br><span class="line">  4c:   83 ec 0c                sub    $0xc,%esp</span><br><span class="line">  4f:   8d 45 cc                lea    -0x34(%ebp),%eax</span><br><span class="line">  52:   50                      push   %eax</span><br><span class="line">  53:   e8 fc ff ff ff          call   54 &lt;IhCtSRZPQx+0x54&gt;</span><br><span class="line">  58:   83 c4 10                add    $0x10,%esp</span><br><span class="line">  5b:   89 45 f4                mov    %eax,-0xc(%ebp)</span><br><span class="line">  5e:   83 7d 08 00             cmpl   $0x0,0x8(%ebp)</span><br><span class="line">  62:   78 15                   js     79 &lt;IhCtSRZPQx+0x79&gt;</span><br><span class="line">  64:   8b 45 08                mov    0x8(%ebp),%eax</span><br><span class="line">  67:   3b 45 f4                cmp    -0xc(%ebp),%eax</span><br><span class="line">  6a:   7d 0d                   jge    79 &lt;IhCtSRZPQx+0x79&gt;</span><br><span class="line">  6c:   8d 55 cc                lea    -0x34(%ebp),%edx</span><br><span class="line">  6f:   8b 45 08                mov    0x8(%ebp),%eax</span><br><span class="line">  72:   01 d0                   add    %edx,%eax</span><br><span class="line">  74:   0f b6 00                movzbl (%eax),%eax</span><br><span class="line">  77:   eb 05                   jmp    7e &lt;IhCtSRZPQx+0x7e&gt;</span><br><span class="line">  79:   b8 00 00 00 00          mov    $0x0,%eax</span><br><span class="line">  7e:   c9                      leave  </span><br><span class="line">  7f:   c3                      ret    </span><br><span class="line"></span><br><span class="line">00000080 &lt;eUDisQLe&gt;:</span><br><span class="line">  80:   55                      push   %ebp</span><br><span class="line">  81:   89 e5                   mov    %esp,%ebp</span><br><span class="line">  83:   83 ec 08                sub    $0x8,%esp</span><br><span class="line">  86:   83 ec 08                sub    $0x8,%esp</span><br><span class="line">  89:   68 02 00 00 00          push   $0x2</span><br><span class="line">  8e:   ff 75 08                pushl  0x8(%ebp)</span><br><span class="line">  91:   e8 fc ff ff ff          call   92 &lt;eUDisQLe+0x12&gt;</span><br><span class="line">  96:   83 c4 10                add    $0x10,%esp</span><br><span class="line">  99:   85 c0                   test   %eax,%eax</span><br><span class="line">  9b:   75 10                   jne    ad &lt;eUDisQLe+0x2d&gt;</span><br><span class="line">  9d:   83 ec 0c                sub    $0xc,%esp</span><br><span class="line">  a0:   ff 75 0c                pushl  0xc(%ebp)</span><br><span class="line">  a3:   e8 fc ff ff ff          call   a4 &lt;eUDisQLe+0x24&gt;</span><br><span class="line">  a8:   83 c4 10                add    $0x10,%esp</span><br><span class="line">  ab:   eb 01                   jmp    ae &lt;eUDisQLe+0x2e&gt;</span><br><span class="line">  ad:   90                      nop</span><br><span class="line">  ae:   c9                      leave  </span><br><span class="line">  af:   c3                      ret    </span><br><span class="line"></span><br><span class="line">000000b0 &lt;do_phase&gt;:</span><br><span class="line">  b0:   55                      push   %ebp</span><br><span class="line">  b1:   89 e5                   mov    %esp,%ebp</span><br><span class="line">  b3:   90                      nop</span><br><span class="line">  b4:   90                      nop</span><br><span class="line">  b5:   90                      nop</span><br><span class="line">  b6:   90                      nop</span><br><span class="line">  b7:   90                      nop</span><br><span class="line">  b8:   90                      nop</span><br><span class="line">  b9:   90                      nop</span><br><span class="line">  ba:   90                      nop</span><br><span class="line">  bb:   90                      nop</span><br><span class="line">  bc:   90                      nop</span><br><span class="line">  bd:   90                      nop</span><br><span class="line">  be:   90                      nop</span><br><span class="line">  bf:   90                      nop</span><br><span class="line">  c0:   90                      nop</span><br><span class="line">  c1:   90                      nop</span><br><span class="line">  c2:   90                      nop</span><br><span class="line">  c3:   90                      nop</span><br><span class="line">  c4:   90                      nop</span><br><span class="line">  c5:   90                      nop</span><br><span class="line">  c6:   90                      nop</span><br><span class="line">  c7:   90                      nop</span><br><span class="line">  c8:   90                      nop</span><br><span class="line">  c9:   90                      nop</span><br><span class="line">  ca:   90                      nop</span><br><span class="line">  cb:   90                      nop</span><br><span class="line">  cc:   90                      nop</span><br><span class="line">  cd:   90                      nop</span><br><span class="line">  ce:   90                      nop</span><br><span class="line">  cf:   90                      nop</span><br><span class="line">  d0:   90                      nop</span><br><span class="line">  d1:   90                      nop</span><br><span class="line">  d2:   90                      nop</span><br><span class="line">  d3:   90                      nop</span><br><span class="line">  d4:   90                      nop</span><br><span class="line">  d5:   90                      nop</span><br><span class="line">  d6:   90                      nop</span><br><span class="line">  d7:   90                      nop</span><br><span class="line">  d8:   90                      nop</span><br><span class="line">  d9:   90                      nop</span><br><span class="line">  da:   90                      nop</span><br><span class="line">  db:   90                      nop</span><br><span class="line">  dc:   90                      nop</span><br><span class="line">  dd:   90                      nop</span><br><span class="line">  de:   90                      nop</span><br><span class="line">  df:   90                      nop</span><br><span class="line">  e0:   90                      nop</span><br><span class="line">  e1:   90                      nop</span><br><span class="line">  e2:   90                      nop</span><br><span class="line">  e3:   90                      nop</span><br><span class="line">  e4:   90                      nop</span><br><span class="line">  e5:   90                      nop</span><br><span class="line">  e6:   90                      nop</span><br><span class="line">  e7:   90                      nop</span><br><span class="line">  e8:   90                      nop</span><br><span class="line">  e9:   90                      nop</span><br><span class="line">  ea:   90                      nop</span><br><span class="line">  eb:   90                      nop</span><br><span class="line">  ec:   90                      nop</span><br><span class="line">  ed:   90                      nop</span><br><span class="line">  ee:   90                      nop</span><br><span class="line">  ef:   90                      nop</span><br><span class="line">  f0:   90                      nop</span><br><span class="line">  f1:   90                      nop</span><br><span class="line">  f2:   90                      nop</span><br><span class="line">  f3:   90                      nop</span><br><span class="line">  f4:   5d                      pop    %ebp</span><br><span class="line">  f5:   c3                      ret</span><br></pre></td></tr></table></figure>

<p>经过反汇编，我们查看到如下信息</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __cdecl <span class="title function_">IhCtSRZPQx</span><span class="params">(<span class="type">int</span> a1)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">char</span> s[<span class="number">40</span>]; <span class="comment">// [esp+4h] [ebp-34h] BYREF</span></span><br><span class="line">  <span class="type">int</span> v3; <span class="comment">// [esp+2Ch] [ebp-Ch]</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">strcpy</span>(s, <span class="string">&quot;9kDpkvhLYh5IfRlfwWgijsgzf6Xq6e2m6wn3hoK&quot;</span>);</span><br><span class="line">  v3 = <span class="built_in">strlen</span>(s);</span><br><span class="line">  <span class="keyword">if</span> ( a1 &lt; <span class="number">0</span> || a1 &gt;= v3 )</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    <span class="keyword">return</span> (<span class="type">unsigned</span> __int8)s[a1];</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> __cdecl <span class="title function_">eUDisQLe</span><span class="params">(<span class="type">char</span> *s1, <span class="type">char</span> *s)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> result; <span class="comment">// eax</span></span><br><span class="line"></span><br><span class="line">  result = <span class="built_in">strcmp</span>(s1, <span class="string">&quot;lDdEIUE&quot;</span>);</span><br><span class="line">  <span class="keyword">if</span> ( !result )</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">puts</span>(s);</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>首先我们要查看，<code>puts</code>函数在<code>eUDisQLe</code>函数中，于是我们需要用到这个函数，另一个只是障眼法。关于这个函数，我们需要有两个指针，其中参数<code>s1</code>需要等于<code>lDdEIUE</code>（别忘记加个0x00），参数<code>s2</code>则是我们需要输出的值。</p>
<p>于是我们这里想到，使用栈来传递值。我们构思，首先开辟栈空间，将第二个参数<code>lDdEIUE</code>+<code>&#39;\0&#39;</code>写入栈中，再把第一个参数写入，之后把两个指针都推入栈中，最后<code>call</code>一下函数<code>eUDisQLe</code>即可。我们查找偏移，text偏移量在0x34，所以需要修改的入口为<code>0x34</code>+<code>0xb0</code>。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">节头：</span><br><span class="line">  [Nr] Name              Type            Addr     Off    Size   ES Flg Lk Inf Al</span><br><span class="line">  [ 0]                   NULL            00000000 000000 000000 00      0   0  0</span><br><span class="line">  [ 1] .text             PROGBITS        00000000 000034 0000f6 00  AX  0   0  1</span><br><span class="line">  [ 2] .rel.text         REL             00000000 000328 000020 08   I 11   1  4</span><br><span class="line">  [ 3] .data             PROGBITS        00000000 00012c 000008 00  WA  0   0  4</span><br><span class="line">  [ 4] .rel.data         REL             00000000 000348 000010 08   I 11   3  4</span><br><span class="line">  [ 5] .bss              NOBITS          00000000 000134 000000 00  WA  0   0  1</span><br><span class="line">  [ 6] .rodata           PROGBITS        00000000 000134 00000a 00   A  0   0  1</span><br><span class="line">  [ 7] .comment          PROGBITS        00000000 00013e 00001d 01  MS  0   0  1</span><br><span class="line">  [ 8] .note.GNU-stack   PROGBITS        00000000 00015b 000000 00      0   0  1</span><br><span class="line">  [ 9] .eh_frame         PROGBITS        00000000 00015c 000078 00   A  0   0  4</span><br><span class="line">  [10] .rel.eh_frame     REL             00000000 000358 000018 08   I 11   9  4</span><br><span class="line">  [11] .symtab           SYMTAB          00000000 0001d4 000110 10     12  10  4</span><br><span class="line">  [12] .strtab           STRTAB          00000000 0002e4 000043 00      0   0  1</span><br><span class="line">  [13] .shstrtab         STRTAB          00000000 000370 000063 00      0   0  1</span><br><span class="line">Key to Flags:</span><br><span class="line">  W (write), A (alloc), X (execute), M (merge), S (strings), I (info),</span><br><span class="line">  L (link order), O (extra OS processing required), G (group), T (TLS),</span><br><span class="line">  C (compressed), x (unknown), o (OS specific), E (exclude),</span><br><span class="line">  p (processor specific)</span><br></pre></td></tr></table></figure>

<p>修改之后的如下。此处有一个地方需要解释。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">000000b0 &lt;do_phase&gt;:</span><br><span class="line">  b0:	55                   	push   %ebp</span><br><span class="line">  b1:	89 e5                	mov    %esp,%ebp</span><br><span class="line">  b3:	83 ec 28             	sub    $0x20,%esp</span><br><span class="line">  b6:	c7 45 f0 6c 44 64 45 	movl   $0x4564446c,-0x10(%ebp)</span><br><span class="line">  bd:	c7 45 f4 49 55 45 00 	movl   $0x455549,-0xc(%ebp)</span><br><span class="line">  c4:	c7 45 e6 31 32 33 34 	movl   $0x34333231,-0x1a(%ebp)</span><br><span class="line">  cb:	c7 45 ea 35 36 37 38 	movl   $0x38373635,-0x16(%ebp)</span><br><span class="line">  d2:	66 c7 45 ee 39 00    	movw   $0x39,-0x12(%ebp)</span><br><span class="line">  d8:	83 ec 08             	sub    $0x8,%esp</span><br><span class="line">  db:	8d 45 e6             	lea    -0x1a(%ebp),%eax</span><br><span class="line">  de:	50                   	push   %eax</span><br><span class="line">  df:	8d 45 f0             	lea    -0x10(%ebp),%eax</span><br><span class="line">  e2:	50                   	push   %eax</span><br><span class="line">  e3:	e8 98 ff ff ff       	call   80 &lt;eUDisQLe&gt;</span><br><span class="line">  e8:	83 c4 10             	add    $0x10,%esp</span><br><span class="line">  eb:	c9                   	leave  </span><br><span class="line">  ec:	c3                   	ret    </span><br><span class="line">  ed:	90                   	nop</span><br><span class="line">  ee:	90                   	nop</span><br><span class="line">  ef:	90                   	nop</span><br><span class="line">  f0:	90                   	nop</span><br><span class="line">  f1:	90                   	nop</span><br><span class="line">  f2:	90                   	nop</span><br><span class="line">  f3:	90                   	nop</span><br><span class="line">  f4:	5d                   	pop    %ebp</span><br><span class="line">  f5:	c3                   	ret    </span><br></pre></td></tr></table></figure>

<p>对于下面这一条指令，采用相对寻址。此处无重定位信息（重定位信息可以通过<code>readelf</code>指令获取，在下面给出），因此肯定是call一个与自己相近的.text节中的内容。（而且i386中经常看到，需要重定位的指令，地址会被<code>0xfc ff ff ff</code>填充）由于采用相对寻址，我们可以计算得出这个值。首先我们看我们需要<code>call</code>的函数的地址在<code>0x80</code>，而此处我们的指令执行在<code>0xe4</code>（<code>0xe3</code>这个<code>call</code>之后），经过计算<code>0x80-0xe8</code>（使用<code>0xe8</code>。由于我们<code>call</code>之后<code>PC</code>计数器自动加到下一个指令指向位置（此处在CSAPP流水线设计一节中有所体现，会先根据指令类型读取相应的字节数送入到下一阶段，此时PC计数器已经读完，指向下一条指令开头，而在下一阶段才开始执行该指令），所以我们使用下一条指令的地址）我们得出<code>0xffffff9c</code>即为-104（原码十进制）的补码。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">e3:	e8 98 ff ff ff       	call   80 &lt;eUDisQLe&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">重定位节 &#x27;.rel.text&#x27; at offset 0x328 contains 4 entries:</span><br><span class="line"> 偏移量     信息    类型              符号值      符号名称</span><br><span class="line">00000054  00000c02 R_386_PC32        00000000   strlen</span><br><span class="line">0000008a  00000501 R_386_32          00000000   .rodata</span><br><span class="line">00000092  00000d02 R_386_PC32        00000000   strcmp</span><br><span class="line">000000a4  00000e02 R_386_PC32        00000000   puts</span><br><span class="line"></span><br><span class="line">重定位节 &#x27;.rel.data&#x27; at offset 0x348 contains 2 entries:</span><br><span class="line"> 偏移量     信息    类型              符号值      符号名称</span><br><span class="line">00000000  00000501 R_386_32          00000000   .rodata</span><br><span class="line">00000004  00000f01 R_386_32          000000b0   do_phase</span><br><span class="line"></span><br><span class="line">重定位节 &#x27;.rel.eh_frame&#x27; at offset 0x358 contains 3 entries:</span><br><span class="line"> 偏移量     信息    类型              符号值      符号名称</span><br><span class="line">00000020  00000202 R_386_PC32        00000000   .text</span><br><span class="line">00000040  00000202 R_386_PC32        00000000   .text</span><br><span class="line">00000060  00000202 R_386_PC32        00000000   .text</span><br></pre></td></tr></table></figure>

<p>至此，程序正常运行并输出我们构造第一个参数的值。</p>
<h2 id="phase3"><a href="#phase3" class="headerlink" title="phase3"></a>phase3</h2><h3 id="任务-2"><a href="#任务-2" class="headerlink" title="任务"></a>任务</h3><p>针对给定的可重定位目标文件“phase3.o”，创建生成一个名为“phase3_patch.o”的 二进制可重定位目标文件（注意不允许修改phase3.o模块），使其如下与main.o、phase3.o 模块链接后运行时输出（且仅输出）学号</p>
<p>分析<code>phase3.o</code>，先变成汇编文件。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">Disassembly of section .text:</span><br><span class="line"></span><br><span class="line">00000000 &lt;do_phase&gt;:</span><br><span class="line">   0:   55                      push   %ebp</span><br><span class="line">   1:   89 e5                   mov    %esp,%ebp</span><br><span class="line">   3:   83 ec 18                sub    $0x18,%esp</span><br><span class="line">   6:   c7 45 ea 6a 6b 78 67    movl   $0x67786b6a,-0x16(%ebp)</span><br><span class="line">   d:   c7 45 ee 6f 61 7a 62    movl   $0x627a616f,-0x12(%ebp)</span><br><span class="line">  14:   66 c7 45 f2 79 00       movw   $0x79,-0xe(%ebp)</span><br><span class="line">  1a:   c7 45 f4 00 00 00 00    movl   $0x0,-0xc(%ebp)</span><br><span class="line">  21:   eb 28                   jmp    4b &lt;do_phase+0x4b&gt;</span><br><span class="line">  23:   8d 55 ea                lea    -0x16(%ebp),%edx</span><br><span class="line">  26:   8b 45 f4                mov    -0xc(%ebp),%eax</span><br><span class="line">  29:   01 d0                   add    %edx,%eax</span><br><span class="line">  2b:   0f b6 00                movzbl (%eax),%eax</span><br><span class="line">  2e:   0f b6 c0                movzbl %al,%eax</span><br><span class="line">  31:   0f b6 80 00 00 00 00    movzbl 0x0(%eax),%eax</span><br><span class="line">  38:   0f be c0                movsbl %al,%eax</span><br><span class="line">  3b:   83 ec 0c                sub    $0xc,%esp</span><br><span class="line">  3e:   50                      push   %eax</span><br><span class="line">  3f:   e8 fc ff ff ff          call   40 &lt;do_phase+0x40&gt;</span><br><span class="line">  44:   83 c4 10                add    $0x10,%esp</span><br><span class="line">  47:   83 45 f4 01             addl   $0x1,-0xc(%ebp)</span><br><span class="line">  4b:   8b 45 f4                mov    -0xc(%ebp),%eax</span><br><span class="line">  4e:   83 f8 08                cmp    $0x8,%eax</span><br><span class="line">  51:   76 d0                   jbe    23 &lt;do_phase+0x23&gt;</span><br><span class="line">  53:   83 ec 0c                sub    $0xc,%esp</span><br><span class="line">  56:   6a 0a                   push   $0xa</span><br><span class="line">  58:   e8 fc ff ff ff          call   59 &lt;do_phase+0x59&gt;</span><br><span class="line">  5d:   83 c4 10                add    $0x10,%esp</span><br><span class="line">  60:   90                      nop</span><br><span class="line">  61:   c9                      leave  </span><br><span class="line">  62:   c3                      ret </span><br></pre></td></tr></table></figure>

<p>反汇编之后</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">do_phase</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  _WORD v1[<span class="number">11</span>]; <span class="comment">// [esp+2h] [ebp-16h] BYREF</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">strcpy</span>((<span class="type">char</span> *)v1, <span class="string">&quot;jkxgoazby&quot;</span>);</span><br><span class="line">  <span class="keyword">for</span> ( *(_DWORD *)&amp;v1[<span class="number">5</span>] = <span class="number">0</span>; *(_DWORD *)&amp;v1[<span class="number">5</span>] &lt;= <span class="number">8u</span>; ++*(_DWORD *)&amp;v1[<span class="number">5</span>] )</span><br><span class="line">    <span class="built_in">putchar</span>(HEnztieJvE[*((<span class="type">unsigned</span> __int8 *)v1 + *(_DWORD *)&amp;v1[<span class="number">5</span>])]);</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">putchar</span>(<span class="number">10</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>这个函数主要做的事情为翻译如下</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">void</span> <span class="title function_">do_phase</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">char</span>* input = <span class="string">&quot;jkxgoazby&quot;</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">9</span>; i++) &#123;</span><br><span class="line">        <span class="type">char</span> index = input[i];  <span class="comment">// 如 &#x27;j&#x27; = 106</span></span><br><span class="line">        <span class="type">char</span> output_char = HEnztieJvE[index];</span><br><span class="line">        <span class="built_in">putchar</span>(output_char);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">putchar</span>(<span class="string">&#x27;\n&#x27;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>所以我们要做的应该就是在<code>patch</code>中声明<code>HEnztieJvE</code>数组的值。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">unsigned</span> <span class="type">char</span> HEnztieJvE[<span class="number">256</span>] = &#123;<span class="string">&#x27;0&#x27;</span>,<span class="string">&#x27;0&#x27;</span>,<span class="string">&#x27;0&#x27;</span>,<span class="string">&#x27;0&#x27;</span>,<span class="string">&#x27;0&#x27;</span>,<span class="string">&#x27;0&#x27;</span>,<span class="string">&#x27;0&#x27;</span>,<span class="string">&#x27;0&#x27;</span>,<span class="string">&#x27;0&#x27;</span>,<span class="string">&#x27;0&#x27;</span>,<span class="string">&#x27;0&#x27;</span>,<span class="string">&#x27;0&#x27;</span>,<span class="string">&#x27;0&#x27;</span>,<span class="string">&#x27;0&#x27;</span>,<span class="string">&#x27;0&#x27;</span>,<span class="string">&#x27;0&#x27;</span>,<span class="string">&#x27;0&#x27;</span>,<span class="string">&#x27;0&#x27;</span>,<span class="string">&#x27;0&#x27;</span>,<span class="string">&#x27;0&#x27;</span>,<span class="string">&#x27;0&#x27;</span>,<span class="string">&#x27;0&#x27;</span>,<span class="string">&#x27;0&#x27;</span>,<span class="string">&#x27;0&#x27;</span>,<span class="string">&#x27;0&#x27;</span>,<span class="string">&#x27;0&#x27;</span>,<span class="string">&#x27;0&#x27;</span>,<span class="string">&#x27;0&#x27;</span>,<span class="string">&#x27;0&#x27;</span>,<span class="string">&#x27;0&#x27;</span>,<span class="string">&#x27;0&#x27;</span>,<span class="string">&#x27;0&#x27;</span>,<span class="string">&#x27;0&#x27;</span>,<span class="string">&#x27;0&#x27;</span>,<span class="string">&#x27;0&#x27;</span>,<span class="string">&#x27;0&#x27;</span>,<span class="string">&#x27;0&#x27;</span>,<span class="string">&#x27;0&#x27;</span>,<span class="string">&#x27;0&#x27;</span>,<span class="string">&#x27;0&#x27;</span>,<span class="string">&#x27;0&#x27;</span>,<span class="string">&#x27;0&#x27;</span>,<span class="string">&#x27;0&#x27;</span>,<span class="string">&#x27;0&#x27;</span>,<span class="string">&#x27;0&#x27;</span>,<span class="string">&#x27;0&#x27;</span>,<span class="string">&#x27;0&#x27;</span>,<span class="string">&#x27;0&#x27;</span>,<span class="string">&#x27;0&#x27;</span>,<span class="string">&#x27;0&#x27;</span>,<span class="string">&#x27;0&#x27;</span>,<span class="string">&#x27;0&#x27;</span>,<span class="string">&#x27;0&#x27;</span>,<span class="string">&#x27;0&#x27;</span>,<span class="string">&#x27;0&#x27;</span>,<span class="string">&#x27;0&#x27;</span>,<span class="string">&#x27;0&#x27;</span>,<span class="string">&#x27;0&#x27;</span>,<span class="string">&#x27;0&#x27;</span>,<span class="string">&#x27;0&#x27;</span>,<span class="string">&#x27;0&#x27;</span>,<span class="string">&#x27;0&#x27;</span>,<span class="string">&#x27;0&#x27;</span>,<span class="string">&#x27;0&#x27;</span>,<span class="string">&#x27;0&#x27;</span>,<span class="string">&#x27;0&#x27;</span>,<span class="string">&#x27;0&#x27;</span>,<span class="string">&#x27;0&#x27;</span>,<span class="string">&#x27;0&#x27;</span>,<span class="string">&#x27;0&#x27;</span>,<span class="string">&#x27;0&#x27;</span>,<span class="string">&#x27;0&#x27;</span>,<span class="string">&#x27;0&#x27;</span>,<span class="string">&#x27;0&#x27;</span>,<span class="string">&#x27;0&#x27;</span>,<span class="string">&#x27;0&#x27;</span>,<span class="string">&#x27;0&#x27;</span>,<span class="string">&#x27;0&#x27;</span>,<span class="string">&#x27;0&#x27;</span>,<span class="string">&#x27;0&#x27;</span>,<span class="string">&#x27;0&#x27;</span>,<span class="string">&#x27;0&#x27;</span>,<span class="string">&#x27;0&#x27;</span>,<span class="string">&#x27;0&#x27;</span>,<span class="string">&#x27;0&#x27;</span>,<span class="string">&#x27;0&#x27;</span>,<span class="string">&#x27;0&#x27;</span>,<span class="string">&#x27;0&#x27;</span>,<span class="string">&#x27;0&#x27;</span>,<span class="string">&#x27;0&#x27;</span>,<span class="string">&#x27;0&#x27;</span>,<span class="string">&#x27;0&#x27;</span>,<span class="string">&#x27;0&#x27;</span>,<span class="string">&#x27;0&#x27;</span>,<span class="string">&#x27;0&#x27;</span>,<span class="string">&#x27;0&#x27;</span>,<span class="string">&#x27;0&#x27;</span>,<span class="number">0x36</span>,<span class="number">0x38</span>,<span class="string">&#x27;0&#x27;</span>,<span class="string">&#x27;0&#x27;</span>,<span class="string">&#x27;0&#x27;</span>,<span class="string">&#x27;0&#x27;</span>,<span class="number">0x34</span>,<span class="string">&#x27;0&#x27;</span>,<span class="string">&#x27;0&#x27;</span>,<span class="number">0x31</span>,<span class="number">0x32</span>,<span class="string">&#x27;0&#x27;</span>,<span class="string">&#x27;0&#x27;</span>,<span class="string">&#x27;0&#x27;</span>,<span class="number">0x35</span>,<span class="string">&#x27;0&#x27;</span>,<span class="string">&#x27;0&#x27;</span>,<span class="string">&#x27;0&#x27;</span>,<span class="string">&#x27;0&#x27;</span>,<span class="string">&#x27;0&#x27;</span>,<span class="string">&#x27;0&#x27;</span>,<span class="string">&#x27;0&#x27;</span>,<span class="string">&#x27;0&#x27;</span>,<span class="number">0x33</span>,<span class="number">0x39</span>,<span class="number">0x37</span>,<span class="number">0</span>&#125;;</span><br></pre></td></tr></table></figure>

<p>这样声明，便可以使输出的对应到123456789。</p>
<h2 id="phase5"><a href="#phase5" class="headerlink" title="phase5"></a>phase5</h2><h3 id="任务-3"><a href="#任务-3" class="headerlink" title="任务"></a>任务</h3><p>修改二进制可重定位目标文件“phase5.o”，恢复其中被人为清零的一些重定位记录（分 别对应于本模块中需要重定位的符号引用，注意不允许修改除重定位节以外的内容），使其 如下与main.o 链接后，运行所生成程序时输出对学号进行编码处理后得到的一个特定字符 串“xWM];@ek&gt;”</p>
<h3 id="解决-2"><a href="#解决-2" class="headerlink" title="解决"></a>解决</h3><p>依旧先分析汇编文件。可以看出确实比较复杂。由于这道题需要恢复的是可重定位文件，因此还需要<code>.rel.text</code>的内容，以此一一对照。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br></pre></td><td class="code"><pre><span class="line">Disassembly of section .text:</span><br><span class="line"></span><br><span class="line">00000000 &lt;IhCtSRZPQx&gt;:</span><br><span class="line">   0:   55                      push   %ebp</span><br><span class="line">   1:   89 e5                   mov    %esp,%ebp</span><br><span class="line">   3:   83 ec 30                sub    $0x30,%esp</span><br><span class="line">   6:   c7 45 df 50 44 43 5a    movl   $0x5a434450,-0x21(%ebp)</span><br><span class="line">   d:   c7 45 e3 45 79 68 4c    movl   $0x4c687945,-0x1d(%ebp)</span><br><span class="line">  14:   c7 45 e7 74 5a 78 65    movl   $0x65785a74,-0x19(%ebp)</span><br><span class="line">  1b:   c7 45 eb 64 4e 7a 7a    movl   $0x7a7a4e64,-0x15(%ebp)</span><br><span class="line">  22:   c7 45 ef 65 58 68 64    movl   $0x64685865,-0x11(%ebp)</span><br><span class="line">  29:   c7 45 f3 4e 4e 68 52    movl   $0x52684e4e,-0xd(%ebp)</span><br><span class="line">  30:   c7 45 f7 57 41 79 51    movl   $0x51794157,-0x9(%ebp)</span><br><span class="line">  37:   c6 45 fb 00             movb   $0x0,-0x5(%ebp)</span><br><span class="line">  3b:   c7 45 fc 1d 00 00 00    movl   $0x1d,-0x4(%ebp)</span><br><span class="line">  42:   83 7d 08 00             cmpl   $0x0,0x8(%ebp)</span><br><span class="line">  46:   78 15                   js     5d &lt;IhCtSRZPQx+0x5d&gt;</span><br><span class="line">  48:   8b 45 08                mov    0x8(%ebp),%eax</span><br><span class="line">  4b:   3b 45 fc                cmp    -0x4(%ebp),%eax</span><br><span class="line">  4e:   7d 0d                   jge    5d &lt;IhCtSRZPQx+0x5d&gt;</span><br><span class="line">  50:   8d 55 df                lea    -0x21(%ebp),%edx</span><br><span class="line">  53:   8b 45 08                mov    0x8(%ebp),%eax</span><br><span class="line">  56:   01 d0                   add    %edx,%eax</span><br><span class="line">  58:   0f b6 00                movzbl (%eax),%eax</span><br><span class="line">  5b:   eb 05                   jmp    62 &lt;IhCtSRZPQx+0x62&gt;</span><br><span class="line">  5d:   b8 00 00 00 00          mov    $0x0,%eax</span><br><span class="line">  62:   c9                      leave  </span><br><span class="line">  63:   c3                      ret    </span><br><span class="line"></span><br><span class="line">00000064 &lt;transform_code&gt;:</span><br><span class="line">  64:   55                      push   %ebp</span><br><span class="line">  65:   89 e5                   mov    %esp,%ebp</span><br><span class="line">  67:   8b 45 0c                mov    0xc(%ebp),%eax</span><br><span class="line">  6a:   8b 04 85 00 00 00 00    mov    0x0(,%eax,4),%eax</span><br><span class="line">  71:   83 e0 07                and    $0x7,%eax</span><br><span class="line">  74:   83 f8 07                cmp    $0x7,%eax</span><br><span class="line">  77:   77 74                   ja     ed &lt;transform_code+0x89&gt;</span><br><span class="line">  79:   8b 04 85 44 00 00 00    mov    0x44(,%eax,4),%eax</span><br><span class="line">  80:   ff e0                   jmp    *%eax</span><br><span class="line">  82:   f7 55 08                notl   0x8(%ebp)</span><br><span class="line">  85:   eb 6a                   jmp    f1 &lt;transform_code+0x8d&gt;</span><br><span class="line">  87:   8b 45 0c                mov    0xc(%ebp),%eax</span><br><span class="line">  8a:   8b 04 85 00 00 00 00    mov    0x0(,%eax,4),%eax</span><br><span class="line">  91:   83 e0 03                and    $0x3,%eax</span><br><span class="line">  94:   89 c1                   mov    %eax,%ecx</span><br><span class="line">  96:   d3 7d 08                sarl   %cl,0x8(%ebp)</span><br><span class="line">  99:   eb 56                   jmp    f1 &lt;transform_code+0x8d&gt;</span><br><span class="line">  9b:   8b 45 0c                mov    0xc(%ebp),%eax</span><br><span class="line">  9e:   8b 04 85 00 00 00 00    mov    0x0(,%eax,4),%eax</span><br><span class="line">  a5:   f7 d0                   not    %eax</span><br><span class="line">  a7:   21 45 08                and    %eax,0x8(%ebp)</span><br><span class="line">  aa:   eb 45                   jmp    f1 &lt;transform_code+0x8d&gt;</span><br><span class="line">  ac:   8b 45 0c                mov    0xc(%ebp),%eax</span><br><span class="line">  af:   8b 04 85 00 00 00 00    mov    0x0(,%eax,4),%eax</span><br><span class="line">  b6:   c1 e0 08                shl    $0x8,%eax</span><br><span class="line">  b9:   09 45 08                or     %eax,0x8(%ebp)</span><br><span class="line">  bc:   eb 33                   jmp    f1 &lt;transform_code+0x8d&gt;</span><br><span class="line">  be:   8b 45 0c                mov    0xc(%ebp),%eax</span><br><span class="line">  c1:   8b 04 85 00 00 00 00    mov    0x0(,%eax,4),%eax</span><br><span class="line">  c8:   31 45 08                xor    %eax,0x8(%ebp)</span><br><span class="line">  cb:   eb 24                   jmp    f1 &lt;transform_code+0x8d&gt;</span><br><span class="line">  cd:   8b 45 0c                mov    0xc(%ebp),%eax</span><br><span class="line">  d0:   8b 04 85 00 00 00 00    mov    0x0(,%eax,4),%eax</span><br><span class="line">  d7:   f7 d0                   not    %eax</span><br><span class="line">  d9:   09 45 08                or     %eax,0x8(%ebp)</span><br><span class="line">  dc:   eb 13                   jmp    f1 &lt;transform_code+0x8d&gt;</span><br><span class="line">  de:   8b 45 0c                mov    0xc(%ebp),%eax</span><br><span class="line">  e1:   8b 04 85 00 00 00 00    mov    0x0(,%eax,4),%eax</span><br><span class="line">  e8:   01 45 08                add    %eax,0x8(%ebp)</span><br><span class="line">  eb:   eb 04                   jmp    f1 &lt;transform_code+0x8d&gt;</span><br><span class="line">  ed:   f7 5d 08                negl   0x8(%ebp)</span><br><span class="line">  f0:   90                      nop</span><br><span class="line">  f1:   8b 45 08                mov    0x8(%ebp),%eax</span><br><span class="line">  f4:   5d                      pop    %ebp</span><br><span class="line">  f5:   c3                      ret    </span><br><span class="line"></span><br><span class="line">000000f6 &lt;generate_code&gt;:</span><br><span class="line">  f6:   55                      push   %ebp</span><br><span class="line">  f7:   89 e5                   mov    %esp,%ebp</span><br><span class="line">  f9:   83 ec 10                sub    $0x10,%esp</span><br><span class="line">  fc:   8b 45 08                mov    0x8(%ebp),%eax</span><br><span class="line">  ff:   a3 00 00 00 00          mov    %eax,0x0</span><br><span class="line"> 104:   c7 45 fc 00 00 00 00    movl   $0x0,-0x4(%ebp)</span><br><span class="line"> 10b:   eb 1a                   jmp    127 &lt;generate_code+0x31&gt;</span><br><span class="line"> 10d:   a1 00 00 00 00          mov    0x0,%eax</span><br><span class="line"> 112:   ff 75 fc                pushl  -0x4(%ebp)</span><br><span class="line"> 115:   50                      push   %eax</span><br><span class="line"> 116:   e8 fc ff ff ff          call   117 &lt;generate_code+0x21&gt;</span><br><span class="line"> 11b:   83 c4 08                add    $0x8,%esp</span><br><span class="line"> 11e:   a3 00 00 00 00          mov    %eax,0x0</span><br><span class="line"> 123:   83 45 fc 01             addl   $0x1,-0x4(%ebp)</span><br><span class="line"> 127:   8b 45 fc                mov    -0x4(%ebp),%eax</span><br><span class="line"> 12a:   83 f8 08                cmp    $0x8,%eax</span><br><span class="line"> 12d:   76 de                   jbe    10d &lt;generate_code+0x17&gt;</span><br><span class="line"> 12f:   90                      nop</span><br><span class="line"> 130:   c9                      leave  </span><br><span class="line"> 131:   c3                      ret    </span><br><span class="line"></span><br><span class="line">00000132 &lt;encode_1&gt;:</span><br><span class="line"> 132:   55                      push   %ebp</span><br><span class="line"> 133:   89 e5                   mov    %esp,%ebp</span><br><span class="line"> 135:   83 ec 18                sub    $0x18,%esp</span><br><span class="line"> 138:   83 ec 0c                sub    $0xc,%esp</span><br><span class="line"> 13b:   ff 75 08                pushl  0x8(%ebp)</span><br><span class="line"> 13e:   e8 fc ff ff ff          call   13f &lt;encode_1+0xd&gt;</span><br><span class="line"> 143:   83 c4 10                add    $0x10,%esp</span><br><span class="line"> 146:   89 45 f0                mov    %eax,-0x10(%ebp)</span><br><span class="line"> 149:   c7 45 f4 00 00 00 00    movl   $0x0,-0xc(%ebp)</span><br><span class="line"> 150:   eb 5b                   jmp    1ad &lt;encode_1+0x7b&gt;</span><br><span class="line"> 152:   8b 55 f4                mov    -0xc(%ebp),%edx</span><br><span class="line"> 155:   8b 45 08                mov    0x8(%ebp),%eax</span><br><span class="line"> 158:   01 d0                   add    %edx,%eax</span><br><span class="line"> 15a:   0f b6 00                movzbl (%eax),%eax</span><br><span class="line"> 15d:   0f be c0                movsbl %al,%eax</span><br><span class="line"> 160:   0f b6 80 00 00 00 00    movzbl 0x0(%eax),%eax</span><br><span class="line"> 167:   8b 15 00 00 00 00       mov    0x0,%edx</span><br><span class="line"> 16d:   31 d0                   xor    %edx,%eax</span><br><span class="line"> 16f:   89 c1                   mov    %eax,%ecx</span><br><span class="line"> 171:   8b 55 f4                mov    -0xc(%ebp),%edx</span><br><span class="line"> 174:   8b 45 08                mov    0x8(%ebp),%eax</span><br><span class="line"> 177:   01 d0                   add    %edx,%eax</span><br><span class="line"> 179:   83 e1 7f                and    $0x7f,%ecx</span><br><span class="line"> 17c:   89 ca                   mov    %ecx,%edx</span><br><span class="line"> 17e:   88 10                   mov    %dl,(%eax)</span><br><span class="line"> 180:   8b 55 f4                mov    -0xc(%ebp),%edx</span><br><span class="line"> 183:   8b 45 08                mov    0x8(%ebp),%eax</span><br><span class="line"> 186:   01 d0                   add    %edx,%eax</span><br><span class="line"> 188:   0f b6 00                movzbl (%eax),%eax</span><br><span class="line"> 18b:   3c 1f                   cmp    $0x1f,%al</span><br><span class="line"> 18d:   7e 0f                   jle    19e &lt;encode_1+0x6c&gt;</span><br><span class="line"> 18f:   8b 55 f4                mov    -0xc(%ebp),%edx</span><br><span class="line"> 192:   8b 45 08                mov    0x8(%ebp),%eax</span><br><span class="line"> 195:   01 d0                   add    %edx,%eax</span><br><span class="line"> 197:   0f b6 00                movzbl (%eax),%eax</span><br><span class="line"> 19a:   3c 7f                   cmp    $0x7f,%al</span><br><span class="line"> 19c:   75 0b                   jne    1a9 &lt;encode_1+0x77&gt;</span><br><span class="line"> 19e:   8b 55 f4                mov    -0xc(%ebp),%edx</span><br><span class="line"> 1a1:   8b 45 08                mov    0x8(%ebp),%eax</span><br><span class="line"> 1a4:   01 d0                   add    %edx,%eax</span><br><span class="line"> 1a6:   c6 00 3f                movb   $0x3f,(%eax)</span><br><span class="line"> 1a9:   83 45 f4 01             addl   $0x1,-0xc(%ebp)</span><br><span class="line"> 1ad:   8b 45 f4                mov    -0xc(%ebp),%eax</span><br><span class="line"> 1b0:   3b 45 f0                cmp    -0x10(%ebp),%eax</span><br><span class="line"> 1b3:   7c 9d                   jl     152 &lt;encode_1+0x20&gt;</span><br><span class="line"> 1b5:   8b 45 f0                mov    -0x10(%ebp),%eax</span><br><span class="line"> 1b8:   c9                      leave  </span><br><span class="line"> 1b9:   c3                      ret    </span><br><span class="line"></span><br><span class="line">000001ba &lt;encode_2&gt;:</span><br><span class="line"> 1ba:   55                      push   %ebp</span><br><span class="line"> 1bb:   89 e5                   mov    %esp,%ebp</span><br><span class="line"> 1bd:   83 ec 18                sub    $0x18,%esp</span><br><span class="line"> 1c0:   83 ec 0c                sub    $0xc,%esp</span><br><span class="line"> 1c3:   ff 75 08                pushl  0x8(%ebp)</span><br><span class="line"> 1c6:   e8 fc ff ff ff          call   1c7 &lt;encode_2+0xd&gt;</span><br><span class="line"> 1cb:   83 c4 10                add    $0x10,%esp</span><br><span class="line"> 1ce:   89 45 f0                mov    %eax,-0x10(%ebp)</span><br><span class="line"> 1d1:   c7 45 f4 00 00 00 00    movl   $0x0,-0xc(%ebp)</span><br><span class="line"> 1d8:   eb 5a                   jmp    234 &lt;encode_2+0x7a&gt;</span><br><span class="line"> 1da:   8b 55 f4                mov    -0xc(%ebp),%edx</span><br><span class="line"> 1dd:   8b 45 08                mov    0x8(%ebp),%eax</span><br><span class="line"> 1e0:   01 d0                   add    %edx,%eax</span><br><span class="line"> 1e2:   0f b6 00                movzbl (%eax),%eax</span><br><span class="line"> 1e5:   0f be c0                movsbl %al,%eax</span><br><span class="line"> 1e8:   0f b6 80 00 00 00 00    movzbl 0x0(%eax),%eax</span><br><span class="line"> 1ef:   8b 15 00 00 00 00       mov    0x0,%edx</span><br><span class="line"> 1f5:   8d 0c 10                lea    (%eax,%edx,1),%ecx</span><br><span class="line"> 1f8:   8b 55 f4                mov    -0xc(%ebp),%edx</span><br><span class="line"> 1fb:   8b 45 08                mov    0x8(%ebp),%eax</span><br><span class="line"> 1fe:   01 d0                   add    %edx,%eax</span><br><span class="line"> 200:   83 e1 7f                and    $0x7f,%ecx</span><br><span class="line"> 203:   89 ca                   mov    %ecx,%edx</span><br><span class="line"> 205:   88 10                   mov    %dl,(%eax)</span><br><span class="line"> 207:   8b 55 f4                mov    -0xc(%ebp),%edx</span><br><span class="line"> 20a:   8b 45 08                mov    0x8(%ebp),%eax</span><br><span class="line"> 20d:   01 d0                   add    %edx,%eax</span><br><span class="line"> 20f:   0f b6 00                movzbl (%eax),%eax</span><br><span class="line"> 212:   3c 1f                   cmp    $0x1f,%al</span><br><span class="line"> 214:   7e 0f                   jle    225 &lt;encode_2+0x6b&gt;</span><br><span class="line"> 216:   8b 55 f4                mov    -0xc(%ebp),%edx</span><br><span class="line"> 219:   8b 45 08                mov    0x8(%ebp),%eax</span><br><span class="line"> 21c:   01 d0                   add    %edx,%eax</span><br><span class="line"> 21e:   0f b6 00                movzbl (%eax),%eax</span><br><span class="line"> 221:   3c 7f                   cmp    $0x7f,%al</span><br><span class="line"> 223:   75 0b                   jne    230 &lt;encode_2+0x76&gt;</span><br><span class="line"> 225:   8b 55 f4                mov    -0xc(%ebp),%edx</span><br><span class="line"> 228:   8b 45 08                mov    0x8(%ebp),%eax</span><br><span class="line"> 22b:   01 d0                   add    %edx,%eax</span><br><span class="line"> 22d:   c6 00 2a                movb   $0x2a,(%eax)</span><br><span class="line"> 230:   83 45 f4 01             addl   $0x1,-0xc(%ebp)</span><br><span class="line"> 234:   8b 45 f4                mov    -0xc(%ebp),%eax</span><br><span class="line"> 237:   3b 45 f0                cmp    -0x10(%ebp),%eax</span><br><span class="line"> 23a:   7c 9e                   jl     1da &lt;encode_2+0x20&gt;</span><br><span class="line"> 23c:   8b 45 f0                mov    -0x10(%ebp),%eax</span><br><span class="line"> 23f:   c9                      leave  </span><br><span class="line"> 240:   c3                      ret    </span><br><span class="line"></span><br><span class="line">00000241 &lt;do_phase&gt;:</span><br><span class="line"> 241:   55                      push   %ebp</span><br><span class="line"> 242:   89 e5                   mov    %esp,%ebp</span><br><span class="line"> 244:   83 ec 08                sub    $0x8,%esp</span><br><span class="line"> 247:   68 84 00 00 00          push   $0x84</span><br><span class="line"> 24c:   e8 fc ff ff ff          call   24d &lt;do_phase+0xc&gt;</span><br><span class="line"> 251:   83 c4 04                add    $0x4,%esp</span><br><span class="line"> 254:   a1 00 00 00 00          mov    0x0,%eax</span><br><span class="line"> 259:   83 ec 0c                sub    $0xc,%esp</span><br><span class="line"> 25c:   68 00 00 00 00          push   $0x0</span><br><span class="line"> 261:   ff d0                   call   *%eax</span><br><span class="line"> 263:   83 c4 10                add    $0x10,%esp</span><br><span class="line"> 266:   83 ec 0c                sub    $0xc,%esp</span><br><span class="line"> 269:   68 00 00 00 00          push   $0x0</span><br><span class="line"> 26e:   e8 fc ff ff ff          call   26f &lt;do_phase+0x2e&gt;</span><br><span class="line"> 273:   83 c4 10                add    $0x10,%esp</span><br><span class="line"> 276:   90                      nop</span><br><span class="line"> 277:   c9                      leave  </span><br><span class="line"> 278:   c3                      ret</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">重定位节 <span class="string">&#x27;.rel.text&#x27;</span> at offset 0x778 contains 23 entries:</span><br><span class="line"> 偏移量     信息    类型              符号值      符号名称</span><br><span class="line">0000006d  00000d01 R_386_32          00000020   IhpPFj</span><br><span class="line">0000007c  00000501 R_386_32          00000000   .rodata</span><br><span class="line">0000008d  00000d01 R_386_32          00000020   IhpPFj</span><br><span class="line">00000000  00000000 R_386_NONE       </span><br><span class="line">00000000  00000000 R_386_NONE       </span><br><span class="line">00000000  00000000 R_386_NONE       </span><br><span class="line">000000d3  00000d01 R_386_32          00000020   IhpPFj</span><br><span class="line">000000e4  00000d01 R_386_32          00000020   IhpPFj</span><br><span class="line">00000100  00000e01 R_386_32          00000080   rLCoNb</span><br><span class="line">0000010e  00000e01 R_386_32          00000080   rLCoNb</span><br><span class="line">00000117  00000f02 R_386_PC32        00000064   transform_code</span><br><span class="line">0000011f  00000e01 R_386_32          00000080   rLCoNb</span><br><span class="line">0000013f  00001302 R_386_PC32        00000000   strlen</span><br><span class="line">00000163  00001101 R_386_32          00000080   CnEvua</span><br><span class="line">00000000  00000000 R_386_NONE       </span><br><span class="line">000001c7  00001302 R_386_PC32        00000000   strlen</span><br><span class="line">000001eb  00001101 R_386_32          00000080   CnEvua</span><br><span class="line">000001f1  00000e01 R_386_32          00000080   rLCoNb</span><br><span class="line">0000024d  00001002 R_386_PC32        000000f6   generate_code</span><br><span class="line">00000000  00000000 R_386_NONE       </span><br><span class="line">00000000  00000000 R_386_NONE       </span><br><span class="line">00000000  00000000 R_386_NONE       </span><br><span class="line">0000026f  00001702 R_386_PC32        00000000   puts</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">Symbol table <span class="string">&#x27;.symtab&#x27;</span> contains 25 entries:</span><br><span class="line">   Num:    Value  Size Type    Bind   Vis      Ndx Name</span><br><span class="line">     0: 00000000     0 NOTYPE  LOCAL  DEFAULT  UND </span><br><span class="line">     1: 00000000     0 FILE    LOCAL  DEFAULT  ABS phase5.c</span><br><span class="line">     2: 00000000     0 SECTION LOCAL  DEFAULT    1 </span><br><span class="line">     3: 00000000     0 SECTION LOCAL  DEFAULT    3 </span><br><span class="line">     4: 00000000     0 SECTION LOCAL  DEFAULT    5 </span><br><span class="line">     5: 00000000     0 SECTION LOCAL  DEFAULT    6 </span><br><span class="line">     6: 00000000     0 SECTION LOCAL  DEFAULT    9 </span><br><span class="line">     7: 00000000     0 SECTION LOCAL  DEFAULT   10 </span><br><span class="line">     8: 00000000     0 SECTION LOCAL  DEFAULT    8 </span><br><span class="line">     9: 00000000   110 OBJECT  GLOBAL DEFAULT    3 eRepul</span><br><span class="line">    10: 00000000   100 FUNC    GLOBAL DEFAULT    1 IhCtSRZPQx</span><br><span class="line">    11: 00000070     4 OBJECT  GLOBAL DEFAULT    3 phase_id</span><br><span class="line">    12: 00000074    10 OBJECT  GLOBAL DEFAULT    3 ZJGzLDWt</span><br><span class="line">    13: 00000020    36 OBJECT  GLOBAL DEFAULT    6 IhpPFj</span><br><span class="line">    14: 00000080     4 OBJECT  GLOBAL DEFAULT    3 rLCoNb</span><br><span class="line">    15: 00000064   146 FUNC    GLOBAL DEFAULT    1 transform_code</span><br><span class="line">    16: 000000f6    60 FUNC    GLOBAL DEFAULT    1 generate_code</span><br><span class="line">    17: 00000080   128 OBJECT  GLOBAL DEFAULT    6 CnEvua</span><br><span class="line">    18: 00000132   136 FUNC    GLOBAL DEFAULT    1 encode_1</span><br><span class="line">    19: 00000000     0 NOTYPE  GLOBAL DEFAULT  UND strlen</span><br><span class="line">    20: 000001ba   135 FUNC    GLOBAL DEFAULT    1 encode_2</span><br><span class="line">    21: 00000084     8 OBJECT  GLOBAL DEFAULT    3 encoder</span><br><span class="line">    22: 00000241    56 FUNC    GLOBAL DEFAULT    1 do_phase</span><br><span class="line">    23: 00000000     0 NOTYPE  GLOBAL DEFAULT  UND puts</span><br><span class="line">    24: 0000008c     4 OBJECT  GLOBAL DEFAULT    3 phase</span><br></pre></td></tr></table></figure>



<p>此处需要补充的是重定位信息的结构，比如下面，<code>0x0000006d</code>为text对应地址，<code>0x00000d</code>为对应符号表的符号，<code>0x01</code>代表的是<code>R_386_32</code>绝对定位，而<code>0x02</code>代表的是<code>R_386_PC32</code>相对定位。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">0000006d  00000d01 R_386_32          00000020   IhpPFj</span><br></pre></td></tr></table></figure>

<p>经过分析，8d与d3之间，属于一个跳转表，因此根据上面符号表，对应到相应信息，应该填入</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">000000a1 00000d01</span><br><span class="line">000000b2 00000d01</span><br><span class="line">000000c4 00000d01</span><br></pre></td></tr></table></figure>

<p>对应的函数反汇编为</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __cdecl <span class="title function_">transform_code</span><span class="params">(<span class="type">int</span> a1, <span class="type">int</span> a2)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> v3; <span class="comment">// [esp+8h] [ebp+8h]</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">switch</span> ( IhpPFj[a2] &amp; <span class="number">7</span> )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">0</span>:</span><br><span class="line">      v3 = ~a1;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">      v3 = a1 &gt;&gt; (IhpPFj[a2] &amp; <span class="number">3</span>);</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">      v3 = ~IhpPFj[a2] &amp; a1;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">4</span>:</span><br><span class="line">      v3 = (IhpPFj[a2] &lt;&lt; <span class="number">8</span>) | a1;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">5</span>:</span><br><span class="line">      v3 = IhpPFj[a2] ^ a1;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">6</span>:</span><br><span class="line">      v3 = ~IhpPFj[a2] | a1;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">case</span> <span class="number">7</span>:</span><br><span class="line">      v3 = IhpPFj[a2] + a1;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    <span class="keyword">default</span>:</span><br><span class="line">      v3 = -a1;</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> v3;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>而下面的函数没有缺失重定位，我们可以得到</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">unsigned</span> <span class="type">int</span> __cdecl <span class="title function_">generate_code</span><span class="params">(<span class="type">int</span> a1)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> result; <span class="comment">// eax</span></span><br><span class="line">  <span class="type">unsigned</span> <span class="type">int</span> i; <span class="comment">// [esp+Ch] [ebp-4h]</span></span><br><span class="line"></span><br><span class="line">  rLCoNb = a1;</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; ; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    result = i;</span><br><span class="line">    <span class="keyword">if</span> ( i &gt; <span class="number">8</span> )</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    rLCoNb = transform_code(rLCoNb, i);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> <span class="title function_">do_phase</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  generate_code(<span class="number">132</span>);</span><br><span class="line">  MEMORY[<span class="number">0</span>](<span class="number">0</span>);<span class="comment">//infomation lost</span></span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">puts</span>(<span class="number">0</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>do_phase</code>中有缺失的重定位信息，但是我们可以根据分析来分析出来。</p>
<p>我们<code>do_phase</code>调用generate_code(132)（其实就是0x84），通过这个一系列操作，返回了修改了<code>rLCoNb</code>。</p>
<p>而我们接下来看两个加密函数。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __cdecl <span class="title function_">encode_1</span><span class="params">(<span class="type">char</span> *s)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">signed</span> <span class="type">int</span> v2; <span class="comment">// [esp+8h] [ebp-10h]</span></span><br><span class="line">  <span class="type">signed</span> <span class="type">int</span> i; <span class="comment">// [esp+Ch] [ebp-Ch]</span></span><br><span class="line"></span><br><span class="line">  v2 = <span class="built_in">strlen</span>(s);</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; v2; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    s[i] = ((<span class="type">unsigned</span> __int8)MEMORY[<span class="number">0</span>] ^ CnEvua[s[i]]) &amp; <span class="number">0x7F</span>; <span class="comment">// infomation lost</span></span><br><span class="line">    <span class="keyword">if</span> ( s[i] &lt;= <span class="number">31</span> || s[i] == <span class="number">127</span> )</span><br><span class="line">      s[i] = <span class="number">63</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> v2;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __cdecl <span class="title function_">encode_2</span><span class="params">(<span class="type">char</span> *s)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">signed</span> <span class="type">int</span> v2; <span class="comment">// [esp+8h] [ebp-10h]</span></span><br><span class="line">  <span class="type">signed</span> <span class="type">int</span> i; <span class="comment">// [esp+Ch] [ebp-Ch]</span></span><br><span class="line"></span><br><span class="line">  v2 = <span class="built_in">strlen</span>(s);</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; v2; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    s[i] = (CnEvua[s[i]] + rLCoNb) &amp; <span class="number">0x7F</span>;</span><br><span class="line">    <span class="keyword">if</span> ( s[i] &lt;= <span class="number">31</span> || s[i] == <span class="number">127</span> )</span><br><span class="line">      s[i] = <span class="number">42</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> v2;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>所以根据<code>encode_2</code>，我们确定<code>encode_1</code>缺失的信息为<code>rLCoNb</code></p>
<p>填入</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">00000169 00000e01</span><br></pre></td></tr></table></figure>

<p>最后剩下<code>do_phase</code>函数中</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">00000241 &lt;do_phase&gt;:</span><br><span class="line"> 241:   55                      push   %ebp</span><br><span class="line"> 242:   89 e5                   mov    %esp,%ebp</span><br><span class="line"> 244:   83 ec 08                sub    $0x8,%esp</span><br><span class="line"> 247:   68 84 00 00 00          push   $0x84</span><br><span class="line"> 24c:   e8 fc ff ff ff          call   24d &lt;do_phase+0xc&gt;</span><br><span class="line"> 251:   83 c4 04                add    $0x4,%esp</span><br><span class="line"> 254:   a1 00 00 00 00          mov    0x0,%eax</span><br><span class="line"> 259:   83 ec 0c                sub    $0xc,%esp</span><br><span class="line"> 25c:   68 00 00 00 00          push   $0x0</span><br><span class="line"> 261:   ff d0                   call   *%eax</span><br><span class="line"> 263:   83 c4 10                add    $0x10,%esp</span><br><span class="line"> 266:   83 ec 0c                sub    $0xc,%esp</span><br><span class="line"> 269:   68 00 00 00 00          push   $0x0</span><br><span class="line"> 26e:   e8 fc ff ff ff          call   26f &lt;do_phase+0x2e&gt;</span><br><span class="line"> 273:   83 c4 10                add    $0x10,%esp</span><br><span class="line"> 276:   90                      nop</span><br><span class="line"> 277:   c9                      leave  </span><br><span class="line"> 278:   c3                      ret</span><br></pre></td></tr></table></figure>

<p>经过分析，我们知道这里将一个值放入了<code>%eax</code>中，而后又把一个变量放入了栈中作为第一个参数。解<code>%eax</code>中的地址。最后放入了一个变量地址，<code>call</code>了<code>puts</code>。（根据符号表<code>26f</code>为<code>puts</code>）这个放入<code>%eax</code>中的值，应该是一个指针，指向了加密函数，而后两个变量则为同一个变量，里面存放的是一个值，用于加密，输出。分析符号表中的<code>.data</code>。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"> 9: 00000000   110 OBJECT  GLOBAL DEFAULT    3 eRepul</span><br><span class="line">11: 00000070     4 OBJECT  GLOBAL DEFAULT    3 phase_id</span><br><span class="line">12: 00000074    10 OBJECT  GLOBAL DEFAULT    3 ZJGzLDWt</span><br><span class="line">14: 00000080     4 OBJECT  GLOBAL DEFAULT    3 rLCoNb</span><br><span class="line">21: 00000084     8 OBJECT  GLOBAL DEFAULT    3 encoder</span><br><span class="line">24: 0000008c     4 OBJECT  GLOBAL DEFAULT    3 phase</span><br></pre></td></tr></table></figure>

<p>经查，一共有这么几个变量位于<code>.data</code>中，我们可以通过<code>gdb</code>添加<code>do_phase</code>的断点，然后<code>info variable</code>，找到变量的地址，使用<code>print /x *0x地址</code>我们得到下表信息。根据分析，<code>phase</code>指向的是<code>do_phase</code>，<code>encoder</code>指向的是<code>encode</code>函数，而<code>ZJGzLDWt</code>，很明显，长度为10，必然是123456789和\0。<code>phase_id</code>为指针，指向<code>.rodata</code>的开头。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">Non-debugging symbols:</span><br><span class="line">0x0804a000  _fp_hw</span><br><span class="line">0x0804a004  _IO_stdin_used</span><br><span class="line">0x0804a020  idhGNF //f1abf6e2</span><br><span class="line">0x0804a0c8  challenge</span><br><span class="line">0x0804a180  IhpPFj //存储-4651</span><br><span class="line">0x0804a1e0  CnEvua //0x03020100</span><br><span class="line">0x0804a260  __GNU_EH_FRAME_HDR</span><br><span class="line">0x0804a494  __FRAME_END__</span><br><span class="line">0x0804bf0c  __frame_dummy_init_array_entry</span><br><span class="line">0x0804bf0c  __init_array_start</span><br><span class="line">0x0804bf10  __do_global_dtors_aux_fini_array_entry</span><br><span class="line">0x0804bf10  __init_array_end</span><br><span class="line">0x0804bf14  _DYNAMIC</span><br><span class="line">0x0804c000  _GLOBAL_OFFSET_TABLE_</span><br><span class="line">0x0804c020  __data_start</span><br><span class="line">0x0804c020  data_start</span><br><span class="line">0x0804c024  __dso_handle</span><br><span class="line">0x0804c040  eRepul //0xad45a32</span><br><span class="line">0x0804c0b0  phase_id //804a160 指针，存储的地址指向.rodata的开头</span><br><span class="line">0x0804c0b4  ZJGzLDWt //123456789</span><br><span class="line">0x0804c0c0  rLCoNb //0xffffffff</span><br><span class="line">0x0804c0c4  encoder //0x080492e4</span><br><span class="line">0x0804c0cc  phase //phase指向的是do_phase 0x080493f9</span><br><span class="line">0x0804c0d0  __TMC_END__</span><br><span class="line">0x0804c0d0  __bss_start</span><br><span class="line">0x0804c0d0  _edata</span><br><span class="line">0x0804c0d0  completed</span><br><span class="line">0x0804c0d4  _end</span><br><span class="line">0xf7fd4000  __ehdr_start</span><br><span class="line">0xf7ff1100  debopts</span><br><span class="line">0xf7ff1360  unsecure_envvars</span><br><span class="line">0xf7ff14a0  audit_iface_names</span><br></pre></td></tr></table></figure>

<p>经过分析，最后三个数据我们需要填入</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">00000255 00001501</span><br><span class="line">0000025d 00000c01</span><br><span class="line">0000026a 00000c01</span><br></pre></td></tr></table></figure>

<p>最后得出结果。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">./linkbomb </span><br><span class="line">xWM];@ek&gt;</span><br></pre></td></tr></table></figure>


        </div>

        
            <section class="post-copyright">
                
                    <p class="copyright-item">
                        <span>Author:</span>
                        <span>Gazettm</span>
                    </p>
                
                
                    <p class="copyright-item">
                        <span>Permalink:</span>
                        <span><a href="http://gazettm.github.io/2025/12/26/NJU-linklab/">http://gazettm.github.io/2025/12/26/NJU-linklab/</a></span>
                    </p>
                
                
                

            </section>
        
        <section class="post-tags">
            <div>
                <span>Tag(s):</span>
                <span class="tag">
                    
                    
                        <a href="/tags/CSAPP/"># CSAPP</a>
                    
                        
                </span>
            </div>
            <div>
                <a href="javascript:window.history.back();">back</a>
                <span>· </span>
                <a href="/">home</a>
            </div>
        </section>
        <section class="post-nav">
            
            
            <a class="next" rel="next" href="/2025/12/20/CSAPP-ECF/">CSAPP_ECF</a>
            
        </section>


    </article>
</div>

            </div>
            <footer id="footer" class="footer">
    <div class="copyright">
        <span>© Gazettm | Powered by <a href="https://hexo.io" target="_blank">Hexo</a> & <a href="https://github.com/Siricee/hexo-theme-Chic" target="_blank">Chic</a></span>
    </div>
</footer>

    </div>
</body>

</html>